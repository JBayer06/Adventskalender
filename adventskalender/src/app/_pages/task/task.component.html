<div class="spinner-border text-primary" *ngIf="loading"></div>
<div *ngIf="task && !loading">
    <h1>Aufgabe {{task.day}}</h1>

    <div class="row mt-5">
        <div class="col col-12 col-lg-6 pb-5">
            <img class="img-fluid" [src]="remoteService.getImageUrl('tasks/images/'+task.day, authenticationService)">
            <div class="card p-3">
                {{task[authenticationService.isYoung ? 'young' : 'old'].description}}
            </div>
        </div>
        <div class="col col-12 col-lg-6">
            <div class="alert alert-primary" *ngIf="task.status == 'OPEN'">
                Wo befindet sich der Gegenstand? Klicke auf das entsprechende Quadrat.
            </div>
            <div class="alert" [class.alert-success]="task.solutionStatus == 'CORRECT'" [class.alert-danger]="task.solutionStatus == 'INCORRECT'" *ngIf="task.status == 'SOLVED'">
                Die korrekte Lösung ist {{getCorrectSolutionsString()}}. {{task.guess ? 'Deine Antwort (' + task.guess.col + task.guess.row + ') ist ' + (task.solutionStatus == 'CORRECT' ? 'korrekt' : 'falsch') + '.' : 'Du hast keine Antwort abgegeben.'}}
            </div>

            <div class="map-holder">
                <img src="assets/coordinates/map.jpg" class="img-fluid">
                <table class="fields">
                    <tr *ngFor="let row of rows; index as colIdx">
                        <td class="space-field"></td>
                        <td class="field" [class.cursor-pointer]="task.status == 'OPEN'" [class.selected]="selectedField && row == selectedField.row && col == selectedField.col" (click)="selectField(col, row)" [title]="col + ' ' + row" *ngFor="let col of cols; index as rowIdx"></td>
                    </tr>
                    <tr>
                        <td class="space-field"></td>
                        <td *ngFor="let row of rows; index as colIdx" class="space-field"></td>
                    </tr>
                </table>
            </div>

            <!--<map name="image-map">usemap="#image-map"
                <ng-container *ngFor="let col of cols; index as colIdx">
                    <area class="cursor-pointer" (click)="selectField(col, row)" [title]="col + ' ' + row" [coords]="(colIdx+1)*100 + ',' + rowIdx * 100 + ',' +  (colIdx+2)*100 + ',' + (rowIdx + 1) * 100" shape="rect" *ngFor="let row of rows; index as rowIdx">
                </ng-container>
            </map>-->

            <div class="alert alert-primary" *ngIf="selectedField && task.status == 'OPEN'">
                Du hast das Feld <b>{{selectedField.col}} {{selectedField.row}}</b> ausgewählt. Ist das korrekt? Dann klicke auf <i>Abgeben</i>, um deine Lösung zu speichern.
            </div>
        </div>
    </div>
    <div class="mt-5">
        <a class="btn btn-secondary mr-2" routerLink="/tasks">Zurück</a>
        <button class="btn btn-success" [disabled]="!selectedField" *ngIf="task.status == 'OPEN'" (click)="save()">Speichern</button>
    </div>

</div>